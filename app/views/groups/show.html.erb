<p>
  <b>Name:</b>
  <%= @group.name %>
</p>

<p>
  <b>Owner:</b>
  <%= @group.user.display_name %>
</p>

<br/>

<div class="well">
  <h2>Students</h2>
  <table class="table table-striped table-bordered">
    <thead>
      <th>Student Name</th>
      <th>Last Logged in</th>
      <th>Account Balance</th>
      <th>Actions</th>
    </thead>
    <tbody>
      <% if @group.members.count > 0 %>
        <% @group.members.each do |member| %>
          <% if member.student? %>
            <tr>
              <td><%= link_to(member.display_name, user_path(member)) %></td>
              <td><%= member.last_sign_in_at != nil ? I18n.l(member.last_sign_in_at) : "Never" %></td>
              <td><%= number_to_currency(member.account(@group.id).balance) %></td>
              <td><%= link_to("Delete", user_path(member), remote: true, method: "delete", confirm: "Are you sure? This action can't be undone!") %></td>
            </tr>
          <% end %>
        <% end %>
      <% else %>
        <tr>
          <td colspan="100">You have no students defined in this group</td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= link_to 'Add Student', new_student_users_path(group_id: @group.id) %> |
  <%= link_to 'Edit', edit_group_path(@group) %>
</div>

<div class="well">
  <h2>Stores</h2>
  <table class="table table-striped table-bordered">
    <thead>
      <th>Name</th>
      <th>Owners</th>
      <th>Balance</th>
    </thead>
    <% if @group.stores.count > 0 %>
      <tbody>
        <% @group.stores.each do |store| %>
          <tr>
            <td><%= link_to(store.name, store_path(store))%></td>
            <td>
              <% store.store_owners.each do |owner| %>
                <%= link_to(owner.user.display_name, user_path(owner.user)) %>&nbsp;
              <% end %>
            </td>
            <td><%= number_to_currency(store.account.balance) %></td>
          </tr>
        <% end %>
      </tbody>
    <% end %>
  </table>
</div>
