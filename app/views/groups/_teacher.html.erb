<% accounts = @group.accounts.order("balance DESC") %>

<div class="row-fluid">

  <div class="span8">
    <h2>Info</h2>
    <p>There are 20 days until payday.</p>
    <hr>

    <h2>Disputed Transactions</h2>
    <table class="table table-striped table-bordered">
      <thead>
        <th>ID</th>
        <th>Amount</th>
        <th>To</th>
        <th>From</th>
      </thead>
      <tbody>
        <% transactions = @group.transactions.where(disputed: true) %>
        <% if transactions.count > 1 %>

        <% else %>
          <tr>
            <td colspan="100">You have no disputed transactions.</td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <hr>
    <h2>Requested Stores</h2>
    <table class="table table-striped table-bordered">
      <thead>
        <th>Name</th>
        <th>Description</th>
        <th>Student</th>
        <th></th>
      </thead>
      <tbody>
        <tr>
          <td colspan="100">You have no requested stores.</td>
        </tr></tbody>
    </table>

  </div>

  <div class="span4 pull-right">
    <h2>Class Actions</h2>
    <div class="well">
      <div style="padding: 2px;">
        <%= link_to "Bonus Entire Class", new_class_transaction_group_transactions_path(@group, from_account_id: @group.group_account.id), class: "btn btn-success btn-block", style: "width: 140px;" %>
      </div>
      <div style="padding: 2px;">
        <%= link_to "Fine Entire Class", new_class_transaction_group_transactions_path(@group, to_account_id: @group.group_account.id), class: "btn btn-danger btn-block", style: "width: 140px;" %>
      </div>
    </div>

  <h2>Highest Accounts</h2>
  <table class="table table-striped table-bordered">
    <thead>
      <th>Account Balance</th>
      <th>Owner</th>
    </thead>
    <tbody>
      <% if accounts.count > 0 %>
        <% accounts[0..5].each do |account| %>
          <tr>
            <td><%= number_to_currency(account.balance) %></td>
            <td>
              <%=
                if account.owner_type == "Store"
                  link_to(account.display_name, group_store_path(@group, account.owner))
                elsif account.owner_type == "User"
                  link_to(account.display_name, group_student_path(@group, account.owner))
                end
              %>
            </td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="100">You have no students defined in this group</td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <h2>Lowest Accounts</h2>
  <table class="table table-striped table-bordered">
    <thead>
      <th>Account Balance</th>
      <th>Owner</th>
    </thead>
    <tbody>
      <% if accounts.count > 0 %>
        <% accounts[-5..-1].reverse_each do |account| %>
          <tr>
            <td><%= number_to_currency(account.balance) %></td>
            <td>
              <%=
                if account.owner_type == "Store"
                  link_to(account.display_name, group_store_path(@group, account.owner))
                elsif account.owner_type == "User"
                  link_to(account.display_name, group_student_path(@group, account.owner))
                end
              %>
            </td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="100">You have no students defined in this group</td>
        </tr>
      <% end %>
    </tbody>
  </table>
  </div>
  <hr>
  <h2>Last 20 Transactions</h2>
  <%= render partial: '/transactions/transactions', locals: { transactions: @group.transactions.limit(20).order("created_at DESC") } %>

</div>